
================================================================================
# CASE 1 | RUN 1/3
# Command: /home/sdp/miniforge3/envs/op_microbench/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/op_microbench/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        19.35%      97.304ms        38.17%     191.989ms       1.371ms     136.464ms        70.79%     136.464ms     974.743us           140  
                                               aten::to         0.04%     188.233us        32.84%     165.171ms       1.652ms       0.000us         0.00%      88.257ms     882.568us           100  
                                         aten::_to_copy         0.15%     729.736us        32.80%     164.983ms       2.062ms       0.000us         0.00%      88.257ms       1.103ms            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      48.670ms        25.25%      48.670ms       1.217ms            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.02%      93.894us         0.52%       2.630ms     131.509us       0.000us         0.00%      41.065ms       2.053ms            20  
                             AdaptiveAvgPool2DBackward0         0.01%      70.904us         0.50%       2.536ms     126.814us       0.000us         0.00%      41.065ms       2.053ms            20  
                    aten::_adaptive_avg_pool2d_backward         0.22%       1.104ms         0.49%       2.465ms     123.269us      16.791ms         8.71%      41.065ms       2.053ms            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us      39.879ms        20.69%      39.879ms     996.973us            40  
autograd::engine::evaluate_function: SelectBackward0...         0.03%     161.794us         0.65%       3.248ms     162.375us       0.000us         0.00%      39.554ms       1.978ms            20  
                                        SelectBackward0         0.02%     118.848us         0.61%       3.086ms     154.286us       0.000us         0.00%      39.554ms       1.978ms            20  
                                  aten::select_backward         0.03%     127.748us         0.59%       2.967ms     148.343us       0.000us         0.00%      39.554ms       1.978ms            20  
                                       aten::contiguous         0.01%      29.425us         0.18%     888.425us      44.421us       0.000us         0.00%      24.274ms       1.214ms            20  
                                            aten::clone         0.01%      55.991us         0.17%     859.000us      42.950us       0.000us         0.00%      24.274ms       1.214ms            20  
autograd::engine::evaluate_function: ToCopyBackward0...         0.03%     153.187us         7.87%      39.607ms     990.186us       0.000us         0.00%      23.982ms     599.556us            40  
                                        ToCopyBackward0         0.01%      52.010us         7.84%      39.454ms     986.356us       0.000us         0.00%      23.982ms     599.556us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us      23.982ms        12.44%      23.982ms       1.199ms            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      23.933ms        12.42%      23.933ms       1.197ms            20  
                              aten::adaptive_avg_pool2d         0.01%      59.791us         0.29%       1.442ms      72.104us       0.000us         0.00%      23.894ms       1.195ms            20  
                             aten::_adaptive_avg_pool2d         0.15%     732.678us         0.27%       1.382ms      69.114us      23.894ms        12.40%      23.894ms       1.195ms            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us      23.894ms        12.40%      23.894ms       1.195ms            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us      16.791ms         8.71%      16.791ms     839.565us            20  
                                            aten::zeros         0.02%      92.503us         0.39%       1.938ms      96.903us       0.000us         0.00%      15.620ms     781.015us            20  
                                            aten::zero_         0.01%      42.790us         0.35%       1.739ms      86.971us       0.000us         0.00%      15.620ms     781.015us            20  
                                            aten::fill_         0.17%     858.025us         0.34%       1.697ms      84.832us      15.620ms         8.10%      15.620ms     781.015us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      15.620ms         8.10%      15.620ms     781.015us            20  
                                            aten::randn         0.04%     202.926us        59.78%     300.693ms      15.035ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.13%     645.969us         0.13%     645.969us       4.614us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        59.69%     300.219ms        59.69%     300.219ms      15.011ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.15%     765.812us         0.15%     765.812us       9.573us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy        18.45%      92.823ms        18.45%      92.823ms       1.547ms       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         0.72%       3.646ms         0.72%       3.646ms      30.384us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.02%     110.729us         0.02%     110.729us       5.536us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.02%      75.718us         0.30%       1.530ms      76.495us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.28%       1.389ms         0.28%       1.389ms      69.473us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.06%     321.457us         0.08%     405.082us      10.127us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.02%      83.625us         0.02%      83.625us       2.091us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.01%      57.743us         0.02%     125.129us       3.128us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.03%     168.171us         5.52%      27.758ms       1.388ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.08%     425.325us         5.49%      27.589ms       1.379ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.01%      74.617us         0.07%     362.469us      18.123us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 502.985ms
Self XPU time total: 192.770ms

E2E total time: 0.02279471158981323173


# [RUN 1] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 1 | RUN 2/3
# Command: /home/sdp/miniforge3/envs/op_microbench/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/op_microbench/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        21.44%     100.696ms        41.50%     194.962ms       1.393ms     135.993ms        70.77%     135.993ms     971.381us           140  
                                               aten::to         0.04%     177.892us        35.84%     168.349ms       1.683ms       0.000us         0.00%      87.929ms     879.285us           100  
                                         aten::_to_copy         0.15%     706.251us        35.80%     168.171ms       2.102ms       0.000us         0.00%      87.929ms       1.099ms            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      48.467ms        25.22%      48.467ms       1.212ms            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.02%      96.421us         0.55%       2.595ms     129.766us       0.000us         0.00%      40.922ms       2.046ms            20  
                             AdaptiveAvgPool2DBackward0         0.02%      72.850us         0.53%       2.499ms     124.945us       0.000us         0.00%      40.922ms       2.046ms            20  
                    aten::_adaptive_avg_pool2d_backward         0.23%       1.100ms         0.52%       2.426ms     121.302us      16.735ms         8.71%      40.922ms       2.046ms            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us      39.741ms        20.68%      39.741ms     993.527us            40  
autograd::engine::evaluate_function: SelectBackward0...         0.04%     179.492us         0.72%       3.404ms     170.203us       0.000us         0.00%      39.444ms       1.972ms            20  
                                        SelectBackward0         0.02%     115.852us         0.69%       3.225ms     161.228us       0.000us         0.00%      39.444ms       1.972ms            20  
                                  aten::select_backward         0.03%     128.828us         0.66%       3.109ms     155.435us       0.000us         0.00%      39.444ms       1.972ms            20  
                                       aten::contiguous         0.01%      26.994us         0.18%     847.330us      42.366us       0.000us         0.00%      24.187ms       1.209ms            20  
                                            aten::clone         0.01%      54.048us         0.17%     820.336us      41.017us       0.000us         0.00%      24.187ms       1.209ms            20  
autograd::engine::evaluate_function: ToCopyBackward0...         0.04%     204.218us         8.75%      41.089ms       1.027ms       0.000us         0.00%      23.908ms     597.694us            40  
                                        ToCopyBackward0         0.01%      51.975us         8.70%      40.884ms       1.022ms       0.000us         0.00%      23.908ms     597.694us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us      23.908ms        12.44%      23.908ms       1.195ms            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      23.878ms        12.43%      23.878ms       1.194ms            20  
                              aten::adaptive_avg_pool2d         0.01%      57.737us         0.29%       1.385ms      69.246us       0.000us         0.00%      23.875ms       1.194ms            20  
                             aten::_adaptive_avg_pool2d         0.15%     685.709us         0.28%       1.327ms      66.359us      23.875ms        12.42%      23.875ms       1.194ms            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us      23.875ms        12.42%      23.875ms       1.194ms            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us      16.735ms         8.71%      16.735ms     836.768us            20  
                                            aten::zeros         0.02%      95.780us         0.44%       2.073ms     103.638us       0.000us         0.00%      15.566ms     778.320us            20  
                                            aten::zero_         0.01%      47.921us         0.40%       1.869ms      93.444us       0.000us         0.00%      15.566ms     778.320us            20  
                                            aten::fill_         0.20%     920.256us         0.39%       1.821ms      91.048us      15.566ms         8.10%      15.566ms     778.320us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      15.566ms         8.10%      15.566ms     778.320us            20  
                                            aten::randn         0.03%     158.070us        56.34%     264.647ms      13.232ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.13%     595.883us         0.13%     595.883us       4.256us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        56.25%     264.256ms        56.25%     264.256ms      13.213ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.15%     723.799us         0.15%     723.799us       9.047us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy        19.68%      92.441ms        19.68%      92.441ms       1.541ms       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         0.78%       3.671ms         0.78%       3.671ms      30.593us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.02%     107.657us         0.02%     107.657us       5.383us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.01%      67.600us         0.29%       1.379ms      68.945us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.27%       1.253ms         0.27%       1.253ms      62.631us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.07%     327.177us         0.09%     410.256us      10.256us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.02%      83.079us         0.02%      83.079us       2.077us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.01%      54.894us         0.03%     118.051us       2.951us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.03%     152.562us         5.84%      27.449ms       1.372ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.09%     399.384us         5.81%      27.296ms       1.365ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.01%      64.922us         0.07%     320.927us      16.046us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 469.774ms
Self XPU time total: 192.170ms

E2E total time: 0.02278780937194824219


# [RUN 2] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 1 | RUN 3/3
# Command: /home/sdp/miniforge3/envs/op_microbench/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/op_microbench/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        20.49%      95.385ms        40.67%     189.332ms       1.352ms     134.719ms        70.81%     134.719ms     962.280us           140  
                                               aten::to         0.03%     162.564us        35.45%     165.023ms       1.650ms       0.000us         0.00%      87.109ms     871.093us           100  
                                         aten::_to_copy         0.14%     645.460us        35.42%     164.860ms       2.061ms       0.000us         0.00%      87.109ms       1.089ms            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      48.081ms        25.27%      48.081ms       1.202ms            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.02%      93.967us         0.55%       2.541ms     127.029us       0.000us         0.00%      40.491ms       2.025ms            20  
                             AdaptiveAvgPool2DBackward0         0.01%      67.558us         0.53%       2.447ms     122.331us       0.000us         0.00%      40.491ms       2.025ms            20  
                    aten::_adaptive_avg_pool2d_backward         0.23%       1.064ms         0.51%       2.379ms     118.953us      16.521ms         8.68%      40.491ms       2.025ms            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us      39.325ms        20.67%      39.325ms     983.114us            40  
autograd::engine::evaluate_function: SelectBackward0...         0.04%     163.672us         0.70%       3.263ms     163.163us       0.000us         0.00%      39.010ms       1.951ms            20  
                                        SelectBackward0         0.02%     110.384us         0.67%       3.100ms     154.980us       0.000us         0.00%      39.010ms       1.951ms            20  
                                  aten::select_backward         0.03%     118.680us         0.64%       2.989ms     149.460us       0.000us         0.00%      39.010ms       1.951ms            20  
                                       aten::contiguous         0.01%      27.011us         0.18%     850.704us      42.535us       0.000us         0.00%      23.970ms       1.198ms            20  
                                            aten::clone         0.01%      51.896us         0.18%     823.693us      41.185us       0.000us         0.00%      23.970ms       1.198ms            20  
autograd::engine::evaluate_function: ToCopyBackward0...         0.04%     176.654us         8.63%      40.185ms       1.005ms       0.000us         0.00%      23.674ms     591.845us            40  
                                        ToCopyBackward0         0.01%      56.026us         8.59%      40.008ms       1.000ms       0.000us         0.00%      23.674ms     591.845us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us      23.674ms        12.44%      23.674ms       1.184ms            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      23.640ms        12.43%      23.640ms       1.182ms            20  
                              aten::adaptive_avg_pool2d         0.01%      53.395us         0.29%       1.367ms      68.368us       0.000us         0.00%      23.633ms       1.182ms            20  
                             aten::_adaptive_avg_pool2d         0.15%     696.017us         0.28%       1.314ms      65.698us      23.633ms        12.42%      23.633ms       1.182ms            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us      23.633ms        12.42%      23.633ms       1.182ms            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us      16.521ms         8.68%      16.521ms     826.054us            20  
                                            aten::zeros         0.02%      92.271us         0.42%       1.970ms      98.508us       0.000us         0.00%      15.370ms     768.494us            20  
                                            aten::zero_         0.01%      42.091us         0.38%       1.773ms      88.660us       0.000us         0.00%      15.370ms     768.494us            20  
                                            aten::fill_         0.19%     870.640us         0.37%       1.731ms      86.555us      15.370ms         8.08%      15.370ms     768.494us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      15.370ms         8.08%      15.370ms     768.494us            20  
                                            aten::randn         0.03%     139.029us        57.26%     266.528ms      13.326ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.12%     552.001us         0.12%     552.001us       3.943us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        57.18%     266.178ms        57.18%     266.178ms      13.309ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.15%     686.307us         0.15%     686.307us       8.579us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy        19.80%      92.186ms        19.80%      92.186ms       1.536ms       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         0.76%       3.535ms         0.76%       3.535ms      29.455us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.02%      99.138us         0.02%      99.138us       4.957us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.01%      65.951us         0.29%       1.347ms      67.343us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.26%       1.229ms         0.26%       1.229ms      61.440us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.06%     294.256us         0.08%     372.357us       9.309us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.02%      78.101us         0.02%      78.101us       1.953us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.01%      52.613us         0.03%     120.633us       3.016us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.03%     132.939us         5.35%      24.925ms       1.246ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.07%     341.342us         5.33%      24.792ms       1.240ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.01%      57.411us         0.07%     307.704us      15.385us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 465.504ms
Self XPU time total: 190.243ms

E2E total time: 0.02206256389617920061


# [RUN 3] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 1/3
# Command: /home/sdp/miniforge3/envs/op_microbench/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/op_microbench/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.01%      29.581us        17.57%      41.783ms       2.089ms       0.000us         0.00%      13.057ms     652.841us            20  
                                         aten::_to_copy         0.05%     129.406us        17.56%      41.753ms       2.088ms       0.000us         0.00%      13.057ms     652.841us            20  
                                            aten::copy_        12.86%      30.578ms        17.48%      41.568ms       2.078ms      13.057ms        50.08%      13.057ms     652.841us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      13.057ms        50.08%      13.057ms     652.841us            20  
                              aten::adaptive_avg_pool2d         0.01%      30.147us         0.53%       1.258ms      62.902us       0.000us         0.00%      13.015ms     650.739us            20  
                             aten::_adaptive_avg_pool2d         0.24%     574.759us         0.52%       1.228ms      61.395us      13.015ms        49.92%      13.015ms     650.739us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us      13.015ms        49.92%      13.015ms     650.739us            20  
                                            aten::randn         0.03%      74.342us        81.90%     194.703ms       9.735ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.03%      63.756us         0.03%      63.756us       1.594us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        81.85%     194.591ms        81.85%     194.591ms       9.730ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.02%      56.077us         0.02%      56.077us       2.804us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         4.62%      10.990ms         4.62%      10.990ms     549.507us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.02%      43.391us         0.02%      43.391us       2.170us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.25%     583.648us         0.25%     583.648us      29.182us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 237.744ms
Self XPU time total: 26.072ms

E2E total time: 0.01153205633163452079


# [RUN 1] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 2/3
# Command: /home/sdp/miniforge3/envs/op_microbench/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/op_microbench/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.01%      29.894us        18.17%      41.419ms       2.071ms       0.000us         0.00%      13.072ms     653.617us            20  
                                         aten::_to_copy         0.05%     119.134us        18.16%      41.389ms       2.069ms       0.000us         0.00%      13.072ms     653.617us            20  
                                            aten::copy_        13.50%      30.779ms        18.08%      41.219ms       2.061ms      13.072ms        50.07%      13.072ms     653.617us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      13.072ms        50.07%      13.072ms     653.617us            20  
                              aten::adaptive_avg_pool2d         0.01%      26.478us         0.53%       1.199ms      59.954us       0.000us         0.00%      13.033ms     651.669us            20  
                             aten::_adaptive_avg_pool2d         0.23%     530.260us         0.51%       1.173ms      58.631us      13.033ms        49.93%      13.033ms     651.669us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us      13.033ms        49.93%      13.033ms     651.669us            20  
                                            aten::randn         0.03%      68.636us        81.30%     185.302ms       9.265ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.03%      66.937us         0.03%      66.937us       1.673us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        81.25%     185.193ms        81.25%     185.193ms       9.260ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.02%      50.667us         0.02%      50.667us       2.533us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         4.58%      10.440ms         4.58%      10.440ms     521.983us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.02%      42.608us         0.02%      42.608us       2.130us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.25%     572.484us         0.25%     572.484us      28.624us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 227.919ms
Self XPU time total: 26.106ms

E2E total time: 0.01132298707962036202


# [RUN 2] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 3/3
# Command: /home/sdp/miniforge3/envs/op_microbench/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/op_microbench/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                              aten::adaptive_avg_pool2d         0.01%      30.411us         0.55%       1.257ms      62.854us       0.000us         0.00%      13.063ms     653.166us            20  
                             aten::_adaptive_avg_pool2d         0.25%     576.348us         0.53%       1.227ms      61.333us      13.063ms        50.03%      13.063ms     653.166us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us      13.063ms        50.03%      13.063ms     653.166us            20  
                                               aten::to         0.02%      35.378us        17.82%      40.927ms       2.046ms       0.000us         0.00%      13.048ms     652.414us            20  
                                         aten::_to_copy         0.06%     134.378us        17.80%      40.891ms       2.045ms       0.000us         0.00%      13.048ms     652.414us            20  
                                            aten::copy_        13.39%      30.766ms        17.72%      40.700ms       2.035ms      13.048ms        49.97%      13.048ms     652.414us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      13.048ms        49.97%      13.048ms     652.414us            20  
                                            aten::randn         0.03%      75.438us        81.64%     187.528ms       9.376ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.03%      67.929us         0.03%      67.929us       1.698us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        81.59%     187.412ms        81.59%     187.412ms       9.371ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.02%      57.062us         0.02%      57.062us       2.853us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         4.32%       9.934ms         4.32%       9.934ms     496.697us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.02%      47.633us         0.02%      47.633us       2.382us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.25%     574.841us         0.25%     574.841us      28.742us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 229.711ms
Self XPU time total: 26.112ms

E2E total time: 0.01096218824386596680


# [RUN 3] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 1 | RUN 1/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        13.01%      61.629ms        23.98%     113.568ms     811.201us      19.421ms        93.19%      19.421ms     138.719us           140  
                                               aten::to         0.05%     225.641us        15.66%      74.179ms     741.790us       0.000us         0.00%      19.147ms     191.470us           100  
                                         aten::_to_copy         0.15%     694.862us        15.62%      73.953ms     924.416us       0.000us         0.00%      19.147ms     239.338us            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us       9.098ms        43.66%       9.098ms     227.452us            40  
autograd::engine::evaluate_function: ToCopyBackward0...         0.07%     343.623us        10.94%      51.806ms       1.295ms       0.000us         0.00%       7.479ms     186.972us            40  
                                        ToCopyBackward0         0.02%     108.504us        10.87%      51.462ms       1.287ms       0.000us         0.00%       7.479ms     186.972us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us       7.479ms        35.89%       7.479ms     373.944us            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us       2.774ms        13.31%       2.774ms      69.348us            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.05%     241.867us         1.16%       5.495ms     274.758us       0.000us         0.00%       1.092ms      54.608us            20  
                             AdaptiveAvgPool2DBackward0         0.03%     144.084us         1.11%       5.253ms     262.664us       0.000us         0.00%       1.092ms      54.608us            20  
                    aten::_adaptive_avg_pool2d_backward         0.55%       2.592ms         1.08%       5.109ms     255.460us     888.320us         4.26%       1.092ms      54.608us            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us     888.320us         4.26%     888.320us      44.416us            20  
                              aten::adaptive_avg_pool2d         0.01%      61.549us         0.30%       1.423ms      71.173us       0.000us         0.00%     443.840us      22.192us            20  
                             aten::_adaptive_avg_pool2d         0.16%     755.817us         0.29%       1.362ms      68.096us     443.840us         2.13%     443.840us      22.192us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us     443.840us         2.13%     443.840us      22.192us            20  
                                       aten::contiguous         0.01%      51.206us         0.38%       1.780ms      89.024us       0.000us         0.00%     203.840us      10.192us            20  
                                            aten::clone         0.02%     104.067us         0.37%       1.729ms      86.464us       0.000us         0.00%     203.840us      10.192us            20  
autograd::engine::evaluate_function: SelectBackward0...         0.09%     438.529us         1.57%       7.420ms     370.979us       0.000us         0.00%     156.160us       7.808us            20  
                                        SelectBackward0         0.05%     250.108us         1.47%       6.981ms     349.052us       0.000us         0.00%     156.160us       7.808us            20  
                                  aten::select_backward         0.06%     293.680us         1.42%       6.731ms     336.547us       0.000us         0.00%     156.160us       7.808us            20  
                                            aten::zeros         0.04%     201.730us         0.95%       4.490ms     224.511us       0.000us         0.00%      86.400us       4.320us            20  
                                            aten::zero_         0.02%      88.809us         0.85%       4.015ms     200.728us       0.000us         0.00%      86.400us       4.320us            20  
                                            aten::fill_         0.48%       2.276ms         0.83%       3.926ms     196.288us      86.400us         0.41%      86.400us       4.320us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      86.400us         0.41%      86.400us       4.320us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      69.760us         0.33%      69.760us       3.488us            20  
                                            aten::randn         0.04%     182.516us        72.62%     343.915ms      17.196ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.18%     857.860us         0.18%     857.860us       6.128us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        72.53%     343.513ms        72.53%     343.513ms      17.176ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.24%       1.149ms         0.24%       1.149ms      14.368us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy        10.48%      49.623ms        10.48%      49.623ms     827.057us       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         1.06%       5.034ms         1.06%       5.034ms      41.947us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.02%      88.341us         0.02%      88.341us       4.417us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.02%      88.595us         0.34%       1.598ms      79.920us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.31%       1.447ms         0.31%       1.447ms      72.349us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.07%     328.883us         0.09%     426.661us      10.667us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.02%      97.778us         0.02%      97.778us       2.444us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.03%     155.562us         0.07%     340.295us       8.507us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.03%     141.010us         8.22%      38.912ms       1.946ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.07%     316.695us         8.19%      38.771ms       1.939ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.02%      76.498us         0.10%     460.523us      23.026us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 473.602ms
Self XPU time total: 20.839ms

E2E total time: 0.02489380836486816337


# [RUN 1] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 1 | RUN 2/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        12.65%      83.569ms        20.66%     136.451ms     974.650us      27.214ms        95.01%      27.214ms     194.388us           140  
                                               aten::to         0.06%     418.161us        13.04%      86.154ms     861.537us       0.000us         0.00%      26.946ms     269.455us           100  
                                         aten::_to_copy         0.20%       1.307ms        12.98%      85.736ms       1.072ms       0.000us         0.00%      26.946ms     336.819us            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      15.004ms        52.38%      15.004ms     375.104us            40  
autograd::engine::evaluate_function: ToCopyBackward0...         0.07%     476.076us         7.31%      48.275ms       1.207ms       0.000us         0.00%       9.112ms     227.798us            40  
                                        ToCopyBackward0         0.03%     189.110us         7.24%      47.799ms       1.195ms       0.000us         0.00%       9.112ms     227.798us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us       9.112ms        31.81%       9.112ms     455.596us            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us       3.023ms        10.56%       3.023ms      75.584us            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.06%     379.528us         1.19%       7.830ms     391.516us       0.000us         0.00%       1.083ms      54.168us            20  
                             AdaptiveAvgPool2DBackward0         0.04%     256.371us         1.13%       7.451ms     372.540us       0.000us         0.00%       1.083ms      54.168us            20  
                    aten::_adaptive_avg_pool2d_backward         0.57%       3.796ms         1.09%       7.194ms     359.721us     889.440us         3.11%       1.083ms      54.168us            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us     889.440us         3.11%     889.440us      44.472us            20  
                              aten::adaptive_avg_pool2d         0.02%     125.031us         0.39%       2.606ms     130.278us       0.000us         0.00%     454.240us      22.712us            20  
                             aten::_adaptive_avg_pool2d         0.21%       1.408ms         0.38%       2.481ms     124.027us     454.240us         1.59%     454.240us      22.712us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us     454.240us         1.59%     454.240us      22.712us            20  
                                       aten::contiguous         0.01%      76.161us         0.37%       2.456ms     122.791us       0.000us         0.00%     193.920us       9.696us            20  
                                            aten::clone         0.02%     145.968us         0.36%       2.380ms     118.983us       0.000us         0.00%     193.920us       9.696us            20  
autograd::engine::evaluate_function: SelectBackward0...         0.10%     638.696us         1.61%      10.636ms     531.784us       0.000us         0.00%     160.000us       8.000us            20  
                                        SelectBackward0         0.05%     328.651us         1.51%       9.997ms     499.850us       0.000us         0.00%     160.000us       8.000us            20  
                                  aten::select_backward         0.06%     399.079us         1.46%       9.668ms     483.417us       0.000us         0.00%     160.000us       8.000us            20  
                                            aten::zeros         0.04%     294.892us         0.99%       6.523ms     326.150us       0.000us         0.00%      85.120us       4.256us            20  
                                            aten::zero_         0.02%     107.098us         0.88%       5.786ms     289.290us       0.000us         0.00%      85.120us       4.256us            20  
                                            aten::fill_         0.50%       3.295ms         0.86%       5.679ms     283.935us      85.120us         0.30%      85.120us       4.256us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      85.120us         0.30%      85.120us       4.256us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      74.880us         0.26%      74.880us       3.744us            20  
                                            aten::randn         0.04%     287.169us        75.44%     498.329ms      24.916ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.20%       1.348ms         0.20%       1.348ms       9.627us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        75.36%     497.765ms        75.36%     497.765ms      24.888ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.31%       2.041ms         0.31%       2.041ms      25.509us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy         7.51%      49.623ms         7.51%      49.623ms     827.047us       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         1.09%       7.204ms         1.09%       7.204ms      60.029us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.03%     184.037us         0.03%     184.037us       9.202us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.02%     138.977us         0.45%       2.969ms     148.468us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.41%       2.709ms         0.41%       2.709ms     135.431us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.09%     569.111us         0.11%     754.740us      18.869us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.03%     185.629us         0.03%     185.629us       4.641us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.03%     215.962us         0.07%     494.074us      12.352us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.04%     290.163us         7.71%      50.911ms       2.546ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.09%     589.683us         7.66%      50.621ms       2.531ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.02%     164.983us         0.14%     955.732us      47.787us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 660.524ms
Self XPU time total: 28.643ms

E2E total time: 0.03595074415206909318


# [RUN 2] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 1 | RUN 3/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        13.15%      62.737ms        24.23%     115.591ms     825.647us      20.810ms        93.62%      20.810ms     148.643us           140  
                                               aten::to         0.05%     255.924us        15.98%      76.242ms     762.423us       0.000us         0.00%      20.550ms     205.502us           100  
                                         aten::_to_copy         0.14%     661.507us        15.93%      75.986ms     949.829us       0.000us         0.00%      20.550ms     256.877us            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.414ms        46.85%      10.414ms     260.360us            40  
autograd::engine::evaluate_function: ToCopyBackward0...         0.06%     270.401us        11.14%      53.163ms       1.329ms       0.000us         0.00%       7.600ms     190.002us            40  
                                        ToCopyBackward0         0.02%     110.312us        11.09%      52.893ms       1.322ms       0.000us         0.00%       7.600ms     190.002us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us       7.600ms        34.19%       7.600ms     380.004us            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us       2.727ms        12.27%       2.727ms      68.172us            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.05%     228.893us         1.07%       5.121ms     256.038us       0.000us         0.00%       1.077ms      53.856us            20  
                             AdaptiveAvgPool2DBackward0         0.03%     134.745us         1.03%       4.892ms     244.594us       0.000us         0.00%       1.077ms      53.856us            20  
                    aten::_adaptive_avg_pool2d_backward         0.52%       2.465ms         1.00%       4.757ms     237.857us     885.920us         3.99%       1.077ms      53.856us            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us     885.920us         3.99%     885.920us      44.296us            20  
                              aten::adaptive_avg_pool2d         0.01%      54.403us         0.28%       1.345ms      67.257us       0.000us         0.00%     446.880us      22.344us            20  
                             aten::_adaptive_avg_pool2d         0.15%     705.198us         0.27%       1.291ms      64.537us     446.880us         2.01%     446.880us      22.344us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us     446.880us         2.01%     446.880us      22.344us            20  
                                       aten::contiguous         0.01%      56.753us         0.34%       1.644ms      82.191us       0.000us         0.00%     191.200us       9.560us            20  
                                            aten::clone         0.02%     102.745us         0.33%       1.587ms      79.353us       0.000us         0.00%     191.200us       9.560us            20  
autograd::engine::evaluate_function: SelectBackward0...         0.08%     404.123us         1.39%       6.655ms     332.733us       0.000us         0.00%     153.440us       7.672us            20  
                                        SelectBackward0         0.04%     214.024us         1.31%       6.251ms     312.526us       0.000us         0.00%     153.440us       7.672us            20  
                                  aten::select_backward         0.05%     234.481us         1.27%       6.037ms     301.825us       0.000us         0.00%     153.440us       7.672us            20  
                                            aten::zeros         0.04%     191.710us         0.85%       4.077ms     203.837us       0.000us         0.00%      84.800us       4.240us            20  
                                            aten::zero_         0.02%      79.861us         0.76%       3.612ms     180.601us       0.000us         0.00%      84.800us       4.240us            20  
                                            aten::fill_         0.43%       2.052ms         0.74%       3.532ms     176.607us      84.800us         0.38%      84.800us       4.240us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      84.800us         0.38%      84.800us       4.240us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      68.640us         0.31%      68.640us       3.432us            20  
                                            aten::randn         0.03%     148.473us        72.64%     346.520ms      17.326ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.16%     766.978us         0.16%     766.978us       5.478us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        72.57%     346.222ms        72.57%     346.222ms      17.311ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.21%       1.007ms         0.21%       1.007ms      12.586us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy        10.64%      50.781ms        10.64%      50.781ms     846.342us       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         0.95%       4.552ms         0.95%       4.552ms      37.931us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.02%      85.408us         0.02%      85.408us       4.270us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.02%      76.822us         0.36%       1.716ms      85.794us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.33%       1.573ms         0.33%       1.573ms      78.640us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.07%     312.693us         0.08%     404.150us      10.104us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.02%      91.457us         0.02%      91.457us       2.286us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.03%     130.670us         0.06%     298.296us       7.457us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.02%      89.977us         8.15%      38.876ms       1.944ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.04%     201.249us         8.13%      38.786ms       1.939ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.01%      57.566us         0.08%     365.561us      18.278us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 477.054ms
Self XPU time total: 22.228ms

E2E total time: 0.02455937862396240234


# [RUN 3] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 1/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.02%      51.595us         8.93%      21.185ms       1.059ms       0.000us         0.00%      10.293ms     514.652us            20  
                                         aten::_to_copy         0.08%     178.344us         8.91%      21.133ms       1.057ms       0.000us         0.00%      10.293ms     514.652us            20  
                                            aten::copy_         5.11%      12.118ms         8.79%      20.861ms       1.043ms      10.293ms        86.28%      10.293ms     514.652us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.293ms        86.28%      10.293ms     514.652us            20  
                              aten::adaptive_avg_pool2d         0.02%      42.300us         0.69%       1.633ms      81.642us       0.000us         0.00%       1.637ms      81.832us            20  
                             aten::_adaptive_avg_pool2d         0.35%     822.530us         0.67%       1.591ms      79.527us       1.637ms        13.72%       1.637ms      81.832us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us       1.637ms        13.72%       1.637ms      81.832us            20  
                                            aten::randn         0.04%     100.319us        90.38%     214.453ms      10.723ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.05%     110.870us         0.05%     110.870us       2.772us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        90.31%     214.284ms        90.31%     214.284ms      10.714ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.04%      93.647us         0.04%      93.647us       4.682us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         3.68%       8.743ms         3.68%       8.743ms     437.164us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.03%      66.343us         0.03%      66.343us       3.317us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.28%     658.708us         0.28%     658.708us      32.935us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 237.270ms
Self XPU time total: 11.930ms

E2E total time: 0.01143231391906738247


# [RUN 1] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 2/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.02%      47.408us         8.97%      21.235ms       1.062ms       0.000us         0.00%      10.307ms     515.372us            20  
                                         aten::_to_copy         0.08%     181.607us         8.95%      21.188ms       1.059ms       0.000us         0.00%      10.307ms     515.372us            20  
                                            aten::copy_         5.13%      12.155ms         8.83%      20.920ms       1.046ms      10.307ms        86.32%      10.307ms     515.372us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.307ms        86.32%      10.307ms     515.372us            20  
                              aten::adaptive_avg_pool2d         0.02%      35.772us         0.68%       1.607ms      80.329us       0.000us         0.00%       1.634ms      81.680us            20  
                             aten::_adaptive_avg_pool2d         0.34%     803.830us         0.66%       1.571ms      78.541us       1.634ms        13.68%       1.634ms      81.680us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us       1.634ms        13.68%       1.634ms      81.680us            20  
                                            aten::randn         0.04%     101.868us        90.35%     213.952ms      10.698ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.04%     104.714us         0.04%     104.714us       2.618us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        90.28%     213.784ms        90.28%     213.784ms      10.689ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.04%      86.093us         0.04%      86.093us       4.305us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         3.70%       8.765ms         3.70%       8.765ms     438.246us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.02%      58.252us         0.02%      58.252us       2.913us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.28%     670.141us         0.28%     670.141us      33.507us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 236.794ms
Self XPU time total: 11.941ms

E2E total time: 0.01145704984664916957


# [RUN 2] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 3/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.02%      56.028us         8.77%      21.371ms       1.069ms       0.000us         0.00%      10.274ms     513.704us            20  
                                         aten::_to_copy         0.08%     201.001us         8.75%      21.315ms       1.066ms       0.000us         0.00%      10.274ms     513.704us            20  
                                            aten::copy_         4.98%      12.122ms         8.63%      21.018ms       1.051ms      10.274ms        86.23%      10.274ms     513.704us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.274ms        86.23%      10.274ms     513.704us            20  
                              aten::adaptive_avg_pool2d         0.02%      40.928us         0.68%       1.647ms      82.354us       0.000us         0.00%       1.641ms      82.032us            20  
                             aten::_adaptive_avg_pool2d         0.34%     824.648us         0.66%       1.606ms      80.307us       1.641ms        13.77%       1.641ms      82.032us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us       1.641ms        13.77%       1.641ms      82.032us            20  
                                            aten::randn         0.05%     113.513us        90.55%     220.601ms      11.030ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.04%     100.973us         0.04%     100.973us       2.524us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        90.48%     220.427ms        90.48%     220.427ms      11.021ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.04%      96.244us         0.04%      96.244us       4.812us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         3.65%       8.895ms         3.65%       8.895ms     444.773us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.03%      65.472us         0.03%      65.472us       3.274us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.28%     675.503us         0.28%     675.503us      33.775us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 243.618ms
Self XPU time total: 11.915ms

E2E total time: 0.01189584732055664132


# [RUN 3] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 1 | RUN 1/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        13.59%      63.431ms        22.44%     104.732ms     748.087us      21.123ms        93.73%      21.123ms     150.881us           140  
                                               aten::to         0.05%     240.256us        13.85%      64.633ms     646.333us       0.000us         0.00%      20.840ms     208.403us           100  
                                         aten::_to_copy         0.15%     719.874us        13.79%      64.393ms     804.914us       0.000us         0.00%      20.840ms     260.504us            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.393ms        46.11%      10.393ms     259.824us            40  
autograd::engine::evaluate_function: ToCopyBackward0...         0.07%     314.174us         8.91%      41.596ms       1.040ms       0.000us         0.00%       7.774ms     194.356us            40  
                                        ToCopyBackward0         0.03%     137.345us         8.84%      41.282ms       1.032ms       0.000us         0.00%       7.774ms     194.356us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us       7.774ms        34.50%       7.774ms     388.712us            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us       2.887ms        12.81%       2.887ms      72.180us            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.07%     312.490us         1.54%       7.178ms     358.895us       0.000us         0.00%       1.101ms      55.064us            20  
                             AdaptiveAvgPool2DBackward0         0.04%     179.848us         1.47%       6.865ms     343.271us       0.000us         0.00%       1.101ms      55.064us            20  
                    aten::_adaptive_avg_pool2d_backward         0.74%       3.466ms         1.43%       6.686ms     334.278us     887.200us         3.94%       1.101ms      55.064us            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us     887.200us         3.94%     887.200us      44.360us            20  
                              aten::adaptive_avg_pool2d         0.01%      53.090us         0.29%       1.348ms      67.405us       0.000us         0.00%     444.800us      22.240us            20  
                             aten::_adaptive_avg_pool2d         0.15%     716.602us         0.28%       1.295ms      64.751us     444.800us         1.97%     444.800us      22.240us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us     444.800us         1.97%     444.800us      22.240us            20  
                                       aten::contiguous         0.02%      72.586us         0.50%       2.353ms     117.635us       0.000us         0.00%     214.080us      10.704us            20  
                                            aten::clone         0.03%     146.570us         0.49%       2.280ms     114.005us       0.000us         0.00%     214.080us      10.704us            20  
autograd::engine::evaluate_function: SelectBackward0...         0.10%     488.949us         2.08%       9.703ms     485.141us       0.000us         0.00%     150.880us       7.544us            20  
                                        SelectBackward0         0.07%     305.998us         1.97%       9.214ms     460.693us       0.000us         0.00%     150.880us       7.544us            20  
                                  aten::select_backward         0.08%     373.858us         1.91%       8.908ms     445.393us       0.000us         0.00%     150.880us       7.544us            20  
                                            aten::zeros         0.06%     276.109us         1.28%       5.985ms     299.250us       0.000us         0.00%      81.920us       4.096us            20  
                                            aten::zero_         0.02%     112.487us         1.14%       5.339ms     266.933us       0.000us         0.00%      81.920us       4.096us            20  
                                            aten::fill_         0.67%       3.108ms         1.12%       5.226ms     261.308us      81.920us         0.36%      81.920us       4.096us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      81.920us         0.36%      81.920us       4.096us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      68.960us         0.31%      68.960us       3.448us            20  
                                            aten::randn         0.04%     180.618us        73.44%     342.824ms      17.141ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.22%       1.019ms         0.22%       1.019ms       7.279us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        73.35%     342.431ms        73.35%     342.431ms      17.122ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.27%       1.248ms         0.27%       1.248ms      15.597us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy         8.30%      38.754ms         8.30%      38.754ms     645.897us       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         1.24%       5.798ms         1.24%       5.798ms      48.320us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.02%      90.761us         0.02%      90.761us       4.538us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.02%      75.820us         0.36%       1.658ms      82.888us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.32%       1.511ms         0.32%       1.511ms      75.552us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.09%     422.075us         0.12%     566.231us      14.156us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.03%     144.156us         0.03%     144.156us       3.604us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.04%     194.594us         0.09%     437.080us      10.927us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.03%     145.398us         8.31%      38.807ms       1.940ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.06%     273.878us         8.28%      38.662ms       1.933ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.02%      73.242us         0.10%     460.095us      23.005us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 466.817ms
Self XPU time total: 22.537ms

E2E total time: 0.02489897012710571428


# [RUN 1] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 1 | RUN 2/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        13.38%      61.767ms        22.06%     101.858ms     727.558us      21.115ms        93.75%      21.115ms     150.819us           140  
                                               aten::to         0.05%     236.453us        13.66%      63.050ms     630.500us       0.000us         0.00%      20.844ms     208.445us           100  
                                         aten::_to_copy         0.14%     660.459us        13.61%      62.814ms     785.169us       0.000us         0.00%      20.844ms     260.556us            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.386ms        46.11%      10.386ms     259.638us            40  
autograd::engine::evaluate_function: ToCopyBackward0...         0.06%     294.007us         8.84%      40.795ms       1.020ms       0.000us         0.00%       7.754ms     193.838us            40  
                                        ToCopyBackward0         0.03%     130.750us         8.77%      40.501ms       1.013ms       0.000us         0.00%       7.754ms     193.838us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us       7.754ms        34.43%       7.754ms     387.676us            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us       2.906ms        12.90%       2.906ms      72.640us            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.06%     297.207us         1.53%       7.085ms     354.252us       0.000us         0.00%       1.082ms      54.120us            20  
                             AdaptiveAvgPool2DBackward0         0.04%     176.046us         1.47%       6.788ms     339.392us       0.000us         0.00%       1.082ms      54.120us            20  
                    aten::_adaptive_avg_pool2d_backward         0.75%       3.452ms         1.43%       6.612ms     330.590us     882.240us         3.92%       1.082ms      54.120us            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us     882.240us         3.92%     882.240us      44.112us            20  
                              aten::adaptive_avg_pool2d         0.01%      48.730us         0.28%       1.280ms      64.014us       0.000us         0.00%     442.880us      22.144us            20  
                             aten::_adaptive_avg_pool2d         0.15%     683.928us         0.27%       1.232ms      61.578us     442.880us         1.97%     442.880us      22.144us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us     442.880us         1.97%     442.880us      22.144us            20  
                                       aten::contiguous         0.01%      68.262us         0.50%       2.302ms     115.082us       0.000us         0.00%     200.160us      10.008us            20  
                                            aten::clone         0.03%     138.484us         0.48%       2.233ms     111.669us       0.000us         0.00%     200.160us      10.008us            20  
autograd::engine::evaluate_function: SelectBackward0...         0.11%     492.094us         1.93%       8.913ms     445.643us       0.000us         0.00%     151.840us       7.592us            20  
                                        SelectBackward0         0.06%     259.628us         1.82%       8.421ms     421.038us       0.000us         0.00%     151.840us       7.592us            20  
                                  aten::select_backward         0.07%     343.999us         1.77%       8.161ms     408.057us       0.000us         0.00%     151.840us       7.592us            20  
                                            aten::zeros         0.05%     238.608us         1.17%       5.411ms     270.552us       0.000us         0.00%      81.760us       4.088us            20  
                                            aten::zero_         0.02%      93.848us         1.05%       4.858ms     242.878us       0.000us         0.00%      81.760us       4.088us            20  
                                            aten::fill_         0.61%       2.816ms         1.03%       4.764ms     238.186us      81.760us         0.36%      81.760us       4.088us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      81.760us         0.36%      81.760us       4.088us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      70.080us         0.31%      70.080us       3.504us            20  
                                            aten::randn         0.03%     138.896us        74.01%     341.710ms      17.086ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.20%     902.325us         0.20%     902.325us       6.445us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        73.95%     341.405ms        73.95%     341.405ms      17.070ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.25%       1.154ms         0.25%       1.154ms      14.423us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy         8.15%      37.638ms         8.15%      37.638ms     627.298us       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         1.19%       5.496ms         1.19%       5.496ms      45.801us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.02%      82.205us         0.02%      82.205us       4.110us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.02%      80.402us         0.37%       1.699ms      84.939us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.34%       1.553ms         0.34%       1.553ms      77.664us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.08%     385.599us         0.11%     499.981us      12.500us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.02%     114.382us         0.02%     114.382us       2.860us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.04%     197.426us         0.10%     448.671us      11.217us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.02%      89.080us         8.08%      37.319ms       1.866ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.04%     190.077us         8.06%      37.230ms       1.861ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.01%      57.470us         0.08%     370.697us      18.535us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 461.681ms
Self XPU time total: 22.522ms

E2E total time: 0.02408783435821533134


# [RUN 2] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 1 | RUN 3/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":true,"output_size":[7,7],"backward":true}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': True, 'output_size': [7, 7], 'backward': True}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_        13.98%      63.020ms        21.50%      96.896ms     692.114us      20.743ms        93.62%      20.743ms     148.164us           140  
                                               aten::to         0.04%     195.382us        12.58%      56.713ms     567.127us       0.000us         0.00%      20.457ms     204.574us           100  
                                         aten::_to_copy         0.13%     573.092us        12.54%      56.517ms     706.467us       0.000us         0.00%      20.457ms     255.717us            80  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.395ms        46.91%      10.395ms     259.874us            40  
autograd::engine::evaluate_function: ToCopyBackward0...         0.05%     230.628us         7.60%      34.276ms     856.911us       0.000us         0.00%       7.501ms     187.520us            40  
                                        ToCopyBackward0         0.02%      82.548us         7.55%      34.046ms     851.145us       0.000us         0.00%       7.501ms     187.520us            40  
                 Memcpy D2M (DEVICE -> MEMORY(Unknown))         0.00%       0.000us         0.00%       0.000us       0.000us       7.501ms        33.85%       7.501ms     375.040us            20  
at::native::xpu::ElementwiseGlobalRangeKernel<at::na...         0.00%       0.000us         0.00%       0.000us       0.000us       2.778ms        12.54%       2.778ms      69.460us            40  
autograd::engine::evaluate_function: AdaptiveAvgPool...         0.04%     162.753us         0.87%       3.937ms     196.863us       0.000us         0.00%       1.104ms      55.208us            20  
                             AdaptiveAvgPool2DBackward0         0.02%     104.289us         0.84%       3.775ms     188.726us       0.000us         0.00%       1.104ms      55.208us            20  
                    aten::_adaptive_avg_pool2d_backward         0.42%       1.898ms         0.81%       3.670ms     183.511us     887.360us         4.00%       1.104ms      55.208us            20  
at::native::xpu::AdaptiveAvgPool2dBwdSLMChannelsLast...         0.00%       0.000us         0.00%       0.000us       0.000us     887.360us         4.00%     887.360us      44.368us            20  
                              aten::adaptive_avg_pool2d         0.01%      48.551us         0.28%       1.283ms      64.132us       0.000us         0.00%     445.120us      22.256us            20  
                             aten::_adaptive_avg_pool2d         0.15%     663.714us         0.27%       1.234ms      61.704us     445.120us         2.01%     445.120us      22.256us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor_cl<f...         0.00%       0.000us         0.00%       0.000us       0.000us     445.120us         2.01%     445.120us      22.256us            20  
                                       aten::contiguous         0.01%      41.570us         0.28%       1.244ms      62.218us       0.000us         0.00%     216.800us      10.840us            20  
                                            aten::clone         0.02%      79.835us         0.27%       1.203ms      60.140us       0.000us         0.00%     216.800us      10.840us            20  
autograd::engine::evaluate_function: SelectBackward0...         0.05%     231.363us         1.09%       4.926ms     246.282us       0.000us         0.00%     150.400us       7.520us            20  
                                        SelectBackward0         0.04%     191.251us         1.04%       4.694ms     234.714us       0.000us         0.00%     150.400us       7.520us            20  
                                  aten::select_backward         0.04%     198.863us         1.00%       4.503ms     225.151us       0.000us         0.00%     150.400us       7.520us            20  
                                            aten::zeros         0.03%     149.422us         0.67%       3.015ms     150.733us       0.000us         0.00%      81.600us       4.080us            20  
                                            aten::zero_         0.01%      65.956us         0.60%       2.689ms     134.456us       0.000us         0.00%      81.600us       4.080us            20  
                                            aten::fill_         0.33%       1.505ms         0.58%       2.623ms     131.158us      81.600us         0.37%      81.600us       4.080us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      81.600us         0.37%      81.600us       4.080us            20  
at::native::xpu::VectorizedElementwiseKernel<4, at::...         0.00%       0.000us         0.00%       0.000us       0.000us      68.800us         0.31%      68.800us       3.440us            20  
                                            aten::randn         0.04%     171.810us        75.84%     341.837ms      17.092ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.14%     636.783us         0.14%     636.783us       4.548us       0.000us         0.00%       0.000us       0.000us           140  
                                          aten::normal_        75.76%     341.489ms        75.76%     341.489ms      17.074ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.17%     767.462us         0.17%     767.462us       9.593us       0.000us         0.00%       0.000us       0.000us            80  
                                     urEnqueueUSMMemcpy         7.12%      32.094ms         7.12%      32.094ms     534.905us       0.000us         0.00%       0.000us       0.000us            60  
                                  urEnqueueKernelLaunch         0.84%       3.792ms         0.84%       3.792ms      31.601us       0.000us         0.00%       0.000us       0.000us           120  
                                          aten::resize_         0.02%      85.071us         0.02%      85.071us       4.254us       0.000us         0.00%       0.000us       0.000us            20  
                                             aten::rand         0.02%      71.011us         0.35%       1.556ms      77.817us       0.000us         0.00%       0.000us       0.000us            20  
                                         aten::uniform_         0.32%       1.421ms         0.32%       1.421ms      71.033us       0.000us         0.00%       0.000us       0.000us            20  
                                           aten::select         0.06%     286.616us         0.08%     369.486us       9.237us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::as_strided         0.02%      82.870us         0.02%      82.870us       2.072us       0.000us         0.00%       0.000us       0.000us            40  
                                       aten::empty_like         0.02%      97.956us         0.05%     210.402us       5.260us       0.000us         0.00%       0.000us       0.000us            40  
autograd::engine::evaluate_function: torch::autograd...         0.02%      75.012us         8.87%      39.989ms       1.999ms       0.000us         0.00%       0.000us       0.000us            20  
                        torch::autograd::AccumulateGrad         0.04%     181.384us         8.86%      39.914ms       1.996ms       0.000us         0.00%       0.000us       0.000us            20  
                                aten::new_empty_strided         0.01%      50.555us         0.07%     329.892us      16.495us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 450.744ms
Self XPU time total: 22.157ms

E2E total time: 0.02468943595886230469


# [RUN 3] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 1/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.02%      55.475us        10.89%      27.341ms       1.367ms       0.000us         0.00%      10.281ms     514.072us            20  
                                         aten::_to_copy         0.08%     198.220us        10.87%      27.285ms       1.364ms       0.000us         0.00%      10.281ms     514.072us            20  
                                            aten::copy_         4.84%      12.150ms        10.75%      26.999ms       1.350ms      10.281ms        86.19%      10.281ms     514.072us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.281ms        86.19%      10.281ms     514.072us            20  
                              aten::adaptive_avg_pool2d         0.02%      41.069us         0.64%       1.612ms      80.621us       0.000us         0.00%       1.648ms      82.392us            20  
                             aten::_adaptive_avg_pool2d         0.32%     791.404us         0.63%       1.571ms      78.567us       1.648ms        13.81%       1.648ms      82.392us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us       1.648ms        13.81%       1.648ms      82.392us            20  
                                            aten::randn         0.04%     102.620us        88.47%     222.088ms      11.104ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.04%     100.776us         0.04%     100.776us       2.519us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        88.40%     221.925ms        88.40%     221.925ms      11.096ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.03%      87.752us         0.03%      87.752us       4.388us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         5.91%      14.849ms         5.91%      14.849ms     742.446us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.03%      63.983us         0.03%      63.983us       3.199us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.27%     675.173us         0.27%     675.173us      33.759us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 251.041ms
Self XPU time total: 11.929ms

E2E total time: 0.01210403442382812500


# [RUN 1] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 2/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.02%      56.960us         8.82%      21.622ms       1.081ms       0.000us         0.00%      10.329ms     516.464us            20  
                                         aten::_to_copy         0.08%     192.318us         8.80%      21.565ms       1.078ms       0.000us         0.00%      10.329ms     516.464us            20  
                                            aten::copy_         4.94%      12.118ms         8.68%      21.279ms       1.064ms      10.329ms        86.30%      10.329ms     516.464us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.329ms        86.30%      10.329ms     516.464us            20  
                              aten::adaptive_avg_pool2d         0.02%      43.783us         0.65%       1.590ms      79.494us       0.000us         0.00%       1.639ms      81.960us            20  
                             aten::_adaptive_avg_pool2d         0.33%     804.896us         0.63%       1.546ms      77.305us       1.639ms        13.70%       1.639ms      81.960us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us       1.639ms        13.70%       1.639ms      81.960us            20  
                                            aten::randn         0.04%     108.241us        90.53%     221.960ms      11.098ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.04%     101.409us         0.04%     101.409us       2.535us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        90.46%     221.791ms        90.46%     221.791ms      11.090ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.04%      93.273us         0.04%      93.273us       4.664us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         3.74%       9.161ms         3.74%       9.161ms     458.075us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.03%      62.460us         0.03%      62.460us       3.123us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.26%     638.346us         0.26%     638.346us      31.917us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 245.172ms
Self XPU time total: 11.968ms

E2E total time: 0.01188992261886596610


# [RUN 2] Exit code: 0
--------------------------------------------------------------------------------

================================================================================
# CASE 2 | RUN 3/3
# Command: /home/sdp/miniforge3/envs/ruijie/bin/python run.py --op adaptive_avg_pool2d --case {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
# Config: {"dtype":"torch.bfloat16","shape":[8,512,32,32],"channels_last":false,"output_size":[7,7],"backward":false}
================================================================================

/home/sdp/miniforge3/envs/ruijie/lib/python3.10/site-packages/torch/profiler/profiler.py:217: UserWarning: Warning: Profiler clears events at the end of each cycle.Only events from the current cycle will be reported.To keep events across cycles, set acc_events=True.
  _warn_once(
[Single-case] OP: adaptive_avg_pool2d
config: {'dtype': torch.bfloat16, 'shape': [8, 512, 32, 32], 'channels_last': False, 'output_size': [7, 7], 'backward': False}
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg      Self XPU    Self XPU %     XPU total  XPU time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.02%      57.769us         8.87%      21.758ms       1.088ms       0.000us         0.00%      10.321ms     516.068us            20  
                                         aten::_to_copy         0.08%     201.881us         8.85%      21.700ms       1.085ms       0.000us         0.00%      10.321ms     516.068us            20  
                                            aten::copy_         4.98%      12.213ms         8.73%      21.402ms       1.070ms      10.321ms        86.20%      10.321ms     516.068us            20  
                 Memcpy M2D (MEMORY(Unknown) -> DEVICE)         0.00%       0.000us         0.00%       0.000us       0.000us      10.321ms        86.20%      10.321ms     516.068us            20  
                              aten::adaptive_avg_pool2d         0.02%      48.451us         0.68%       1.669ms      83.432us       0.000us         0.00%       1.652ms      82.616us            20  
                             aten::_adaptive_avg_pool2d         0.35%     847.219us         0.66%       1.620ms      81.009us       1.652ms        13.80%       1.652ms      82.616us            20  
at::native::xpu::AdaptiveAvgPool2dKernelFunctor<floa...         0.00%       0.000us         0.00%       0.000us       0.000us       1.652ms        13.80%       1.652ms      82.616us            20  
                                            aten::randn         0.05%     114.451us        90.44%     221.742ms      11.087ms       0.000us         0.00%       0.000us       0.000us            20  
                                            aten::empty         0.04%     109.076us         0.04%     109.076us       2.727us       0.000us         0.00%       0.000us       0.000us            40  
                                          aten::normal_        90.37%     221.555ms        90.37%     221.555ms      11.078ms       0.000us         0.00%       0.000us       0.000us            20  
                                    aten::empty_strided         0.04%      96.557us         0.04%      96.557us       4.828us       0.000us         0.00%       0.000us       0.000us            20  
                                     urEnqueueUSMMemcpy         3.75%       9.188ms         3.75%       9.188ms     459.420us       0.000us         0.00%       0.000us       0.000us            20  
                                          aten::resize_         0.03%      69.191us         0.03%      69.191us       3.460us       0.000us         0.00%       0.000us       0.000us            20  
                                  urEnqueueKernelLaunch         0.27%     666.716us         0.27%     666.716us      33.336us       0.000us         0.00%       0.000us       0.000us            20  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 245.168ms
Self XPU time total: 11.974ms

E2E total time: 0.01187525987625122001


# [RUN 3] Exit code: 0
--------------------------------------------------------------------------------
